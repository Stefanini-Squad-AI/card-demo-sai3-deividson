<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üí≥ TRANSACTION - Gu√≠a de Desarrollo de User Stories</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f7fa;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 3rem 2rem;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.4);
            box-shadow: 0 4px 6px rgba(0,0,0,0.15);
            margin-bottom: 2rem;
        }
        .header h1 {
            font-size: 2.4rem;
            margin-bottom: 0.3rem;
        }
        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        section {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.08);
            margin-bottom: 2rem;
        }
        h2 {
            color: #667eea;
            margin-bottom: 1.2rem;
            font-size: 1.8rem;
            border-bottom: 3px solid #667eea;
            padding-bottom: 0.5rem;
        }
        h3 {
            color: #5a67d8;
            margin: 1.4rem 0 0.8rem;
            font-size: 1.4rem;
        }
        .overview ul {
            list-style: none;
            margin-left: 0;
        }
        .overview li {
            margin-bottom: 0.6rem;
        }
        .us-template {
            background: #f0f4ff;
            border-left: 4px solid #667eea;
            padding: 1.5rem;
            border-radius: 4px;
            margin-bottom: 1.2rem;
        }
        .us-template strong {
            display: block;
            color: #667eea;
            font-size: 1.1rem;
            margin-bottom: 0.3rem;
        }
        .us-template p {
            margin-bottom: 0.6rem;
            font-style: italic;
        }
        .us-template ul {
            margin-left: 1rem;
        }
        .complexity-badge {
            display: inline-block;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.85rem;
            margin-top: 0.5rem;
        }
        .simple {
            background: #c6f6d5;
            color: #22543d;
        }
        .medium {
            background: #fef3c7;
            color: #7c2d12;
        }
        .complex {
            background: #fed7d7;
            color: #742a2a;
        }
        .component-card {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            padding: 1.4rem;
            margin: 1rem 0;
        }
        .component-card h4 {
            margin-top: 0;
            color: #667eea;
        }
        .code-block {
            background: #1e293b;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 6px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            margin: 1rem 0;
        }
        .highlight {
            background: #fffbeb;
            border-left: 4px solid #f59e0b;
            padding: 0.8rem;
            margin: 1rem 0;
            border-radius: 4px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }
        th, td {
            padding: 0.8rem;
            border-bottom: 1px solid #e2e8f0;
            text-align: left;
        }
        th {
            background: #f1f5f9;
            color: #667eea;
            font-weight: 700;
        }
        .back-link {
            display: inline-block;
            padding: 0.8rem 1.5rem;
            background: #667eea;
            color: white;
            text-decoration: none;
            border-radius: 6px;
            transition: background 0.2s;
        }
        .back-link:hover {
            background: #5a67d8;
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>üí≥ TRANSACTION - Administraci√≥n de Transacciones</h1>
            <p>Gu√≠a t√©cnica para escribir User Stories que tocan la gesti√≥n de transacciones con tarjeta de cr√©dito.</p>
        </header>

        <section class="overview">
            <h2>üìã Vista General</h2>
            <p><strong>Prop√≥sito:</strong> Permitir que operadores visualicen, registren, busquen y generen reportes de transacciones de tarjetas de cr√©dito con las mismas teclas de funci√≥n y reglas que los programas legacy COBOL para COTRNxx.</p>
            <p><strong>Contexto de Negocio:</strong> Todas las operaciones con transacciones financieras pasan por este m√≥dulo; incluye listados, b√∫squeda individual, alta de nuevas transacciones y generaci√≥n de reportes mensuales/anuales.</p>
            <ul>
                <li><code>/app/components/transaction/TransactionListScreen.tsx</code> ‚Äì Tabla con b√∫squeda, paginaci√≥n manual y selecci√≥n tipo mainframe (F7, F8, ENTER) para ver detalles.</li>
                <li><code>/app/components/transaction/TransactionViewScreen.tsx</code> ‚Äì Pantalla de visualizaci√≥n detallada con informaci√≥n del comerciante, montos y fechas.</li>
                <li><code>/app/components/transaction/TransactionAddScreen.tsx</code> ‚Äì Formulario de alta con validaciones de monto, fechas, comerciante y confirmaci√≥n.</li>
                <li><code>/app/components/transaction/TransactionReportsScreen.tsx</code> ‚Äì Interfaz para generaci√≥n de reportes mensuales, anuales o personalizados con confirmaci√≥n.</li>
                <li><code>/app/components/transaction/TransactionReportTable.tsx</code> ‚Äì Componente de visualizaci√≥n de reportes con agrupaci√≥n por cuenta, totales y subtotales.</li>
                <li><code>/app/hooks/useTransactionList.ts</code>, <code>useTransactionView.ts</code>, <code>useTransactionAdd.ts</code>, <code>useTransactionReports.ts</code> ‚Äì L√≥gica de negocio, validaciones, navegaci√≥n y consumo de APIs/mocks.</li>
                <li><code>/app/types/transactionList.ts</code>, <code>transactionView.ts</code>, <code>transactionAdd.ts</code>, <code>transactionReports.ts</code> ‚Äì Tipos compartidos y contratos de request/response.</li>
                <li><code>/app/mocks/transactionListHandlers.ts</code>, <code>transactionViewHandlers.ts</code>, <code>transactionAddHandlers.ts</code>, <code>transactionReportsHandlers.ts</ Handlers MSW que permiten desarrollo offline cuando <code>VITE_USE_MOCKS=true</code>.</li>code> 
                <li><code>/app/pages/TransactionListPage.tsx</code>, <code>TransactionViewPage.tsx</code>, <code>TransactionAddPage.tsx</code>, <code>TransactionReportsPage.tsx</code> ‚Äì P√°ginas que envuelven los screens y manejan el routing.</li>
            </ul>
        </section>

        <section class="us-guide">
            <h2>üéØ Gu√≠a de Desarrollo de User Stories</h2>

            <h3>üìù Plantillas Espec√≠ficas de US</h3>
            
            <div class="us-template">
                <strong>Listado y b√∫squeda de transacciones</strong>
                <p>Como <em>operador de tarjetas</em>, quiero <em>ver el listado paginado de transacciones y buscar por ID</em> para <em>localizar r√°pidamente operaciones espec√≠ficas y verificar montos</em>.</p>
                <ul>
                    <li>El listado muestra transacciones con ID, fecha (MM/DD/YY), descripci√≥n y monto formateado.</li>
                    <li>Campo de b√∫squeda acepta Transaction ID num√©rico (m√°x. 16 caracteres) y dispara b√∫squeda con ENTER o bot√≥n.</li>
                    <li>Paginaci√≥n manual con F7 (p√°gina anterior) y F8 (p√°gina siguiente), validando l√≠mites.</li>
                    <li>Selecci√≥n por fila: escribir 'S' en campo de selecci√≥n y presionar ENTER o √≠cono para ver detalles.</li>
                    <li>F3 regresa al men√∫ principal; los montos negativos se muestran en rojo, positivos en verde.</li>
                </ul>
                <span class="complexity-badge simple">Simple (1-2 pts)</span>
            </div>

            <div class="us-template">
                <strong>Visualizaci√≥n de detalles de transacci√≥n</strong>
                <p>Como <em>analista financiero</em>, quiero <em>buscar una transacci√≥n por ID y ver toda su informaci√≥n detallada</em> para <em>validar datos del comerciante, montos y fechas de procesamiento</em>.</p>
                <ul>
                    <li>Campo de b√∫squeda con Transaction ID (m√°x. 16 caracteres); b√∫squeda con ENTER o bot√≥n.</li>
                    <li>Informaci√≥n b√°sica: Transaction ID, Card Number, Type Code, Category Code, Source.</li>
                    <li>Informaci√≥n financiera: Amount (formateado USD), Original Date, Processed Date.</li>
                    <li>Informaci√≥n del comerciante: Merchant ID, Name, City, Zip Code con iconos visuales.</li>
                    <li>F3 = volver, F4 = limpiar pantalla, F5 = ir a listado de transacciones.</li>
                    <li>Soporte para carga inicial con <code>initialTransactionId</code> desde navegaci√≥n previa.</li>
                </ul>
                <span class="complexity-badge simple">Simple (2-3 pts)</span>
            </div>

            <div class="us-template">
                <strong>Alta de transacci√≥n nueva</strong>
                <p>Como <em>operador de back-office</em>, quiero <em>registrar una nueva transacci√≥n ingresando cuenta/tarjeta, montos, comerciante y fechas con confirmaci√≥n</em> para <em>mantener el registro actualizado de operaciones</em>.</p>
                <ul>
                    <li>Identificaci√≥n: Account ID o Card Number (uno obligatorio), validaci√≥n de formato.</li>
                    <li>Datos de transacci√≥n: Type Code, Category Code, Source, Description (texto libre), Amount (formato decimal).</li>
                    <li>Fechas: Original Date y Process Date en formato ISO o texto reconocible.</li>
                    <li>Informaci√≥n de comerciante: Merchant ID, Name, City, Zip Code (todos obligatorios).</li>
                    <li>Confirmaci√≥n en dos pasos: formulario completo ‚Üí pantalla de confirmaci√≥n (Y/N) ‚Üí guardado final.</li>
                    <li>F3 = volver al men√∫, F4 = limpiar formulario, F12 = salir, validaciones en tiempo real.</li>
                    <li>Mensajes de √©xito/error claros; limpieza autom√°tica de formulario tras guardado exitoso.</li>
                </ul>
                <span class="complexity-badge complex">Complejo (5-7 pts)</span>
            </div>

            <div class="us-template">
                <strong>Generaci√≥n de reportes mensuales/anuales</strong>
                <p>Como <em>gerente financiero</em>, quiero <em>generar reportes de transacciones por rango de fechas con confirmaci√≥n</em> para <em>analizar patrones de gasto y generar informes ejecutivos</em>.</p>
                <ul>
                    <li>Selecci√≥n de tipo de reporte: Monthly, Yearly, Custom con tabs visuales.</li>
                    <li>Para Custom: Start Date y End Date con validaciones de formato y rango l√≥gico.</li>
                    <li>Confirmaci√≥n antes de generar (Y/N); validaci√≥n de campos obligatorios seg√∫n tipo.</li>
                    <li>Visualizaci√≥n de reporte: agrupaci√≥n por Card Number y Account ID con subtotales por cuenta.</li>
                    <li>Tabla detallada: Transaction ID, Type/Category (con descripciones), Amount, Processed Date.</li>
                    <li>Totales: Account Total por grupo, Grand Total general, contadores de transacciones y cuentas.</li>
                    <li>F3 = volver, F4 = limpiar, F5 = regenerar reporte, navegaci√≥n fluida entre pesta√±as.</li>
                </ul>
                <span class="complexity-badge complex">Complejo (6-8 pts)</span>
            </div>

            <h3>‚ö° Factores de Aceleraci√≥n</h3>
            
            <div class="component-card">
                <h4>üèÅ useTransactionList hook</h4>
                <p>Gestiona b√∫squeda, paginaci√≥n manual (F7/F8) y selecci√≥n de transacciones tipo mainframe con campo 'S'.</p>
                <p>Puntos clave:</p>
                <ul>
                    <li><code>handleSearch</code>: B√∫squeda por Transaction ID con validaci√≥n num√©rica.</li>
                    <li><code>handleNextPage/handlePreviousPage</code>: Navegaci√≥n con control de l√≠mites y estados.</li>
                    <li><code>handleTransactionSelect</code>: Procesa selecci√≥n 'S' y navega a vista detallada.</li>
                    <li><code>handleInitialLoad</code>: Carga inicial autom√°tica de la primera p√°gina.</li>
                    <li>Formateo de montos con <code>Intl.NumberFormat</code> en USD; colores diferenciados por signo.</li>
                </ul>
            </div>

            <div class="component-card">
                <h4>üîç useTransactionView hook</h4>
                <p>Maneja b√∫squeda y visualizaci√≥n de detalles de transacci√≥n individual con navegaci√≥n integrada.</p>
                <p>Caracter√≠sticas:</p>
                <ul>
                    <li>Soporte para <code>initialTransactionId</code> desde navegaci√≥n previa (desde lista).</li>
                    <li><code>handleSearch</code>: Fetch de datos completos de transacci√≥n por ID.</li>
                    <li><code>handleClearScreen</code>: Limpieza de datos y errores (F4).</li>
                    <li><code>handleBrowseTransactions</code>: Navegaci√≥n r√°pida a lista (F5).</li>
                    <li>Formateo de fechas con <code>toLocaleString</code>; formateo de montos con s√≠mbolo USD.</li>
                </ul>
            </div>

            <div class="component-card">
                <h4>‚ûï useTransactionAdd hook</h4>
                <p>Implementa flujo de alta de transacciones con validaciones complejas, confirmaci√≥n en dos pasos y gesti√≥n de estado de formulario.</p>
                <p>Validaciones incluidas:</p>
                <ul>
                    <li>Account ID o Card Number obligatorio (al menos uno).</li>
                    <li>Transaction Type Code, Category Code, Source obligatorios.</li>
                    <li>Amount: validaci√≥n de formato decimal, no vac√≠o.</li>
                    <li>Merchant ID, Name, City, Zip obligatorios.</li>
                    <li>Fechas: validaci√≥n de formato y rango l√≥gico.</li>
                    <li>Confirmaci√≥n: flujo de dos pasos con pantalla de revisi√≥n antes de guardar.</li>
                </ul>
            </div>

            <div class="component-card">
                <h4>üìä useTransactionReports hook</h4>
                <p>Gestiona generaci√≥n de reportes con m√∫ltiples tipos, validaciones de fechas y confirmaci√≥n.</p>
                <p>Funcionalidades:</p>
                <ul>
                    <li>Tres tipos de reporte: Monthly, Yearly, Custom con validaciones espec√≠ficas.</li>
                    <li>Validaci√≥n de rangos de fechas para Custom (start ‚â§ end).</li>
                    <li>Confirmaci√≥n obligatoria antes de generar (Y/N).</li>
                    <li>Gesti√≥n de estado de reporte: tipo, fechas, datos, visualizaci√≥n.</li>
                    <li>C√°lculos autom√°ticos: subtotales por cuenta, grand total, contadores.</li>
                </ul>
            </div>

            <div class="component-card">
                <h4>üìã TransactionReportTable component</h4>
                <p>Componente de visualizaci√≥n de reportes con agrupaci√≥n, colores y totales calculados.</p>
                <p>Caracter√≠sticas visuales:</p>
                <ul>
                    <li>Agrupaci√≥n por Card Number y Account ID con encabezados destacados.</li>
                    <li>Filas de detalle con Transaction ID, Type/Category descriptions, Amount, Date.</li>
                    <li>Subtotales por cuenta con fondo resaltado.</li>
                    <li>Grand Total al final con tipograf√≠a destacada.</li>
                    <li>Formateo de montos con colores: verde para positivos, rojo para negativos.</li>
                </ul>
            </div>

            <div class="component-card">
                <h4>üß™ MSW Mocks</h4>
                <p>Handlers completos para desarrollo offline y testing:</p>
                <ul>
                    <li><code>transactionListHandlers.ts</code>: Listado con paginaci√≥n, b√∫squeda por ID, datos de prueba variados.</li>
                    <li><code>transactionViewHandlers.ts</code>: Detalles completos de transacci√≥n con informaci√≥n de comerciante.</li>
                    <li><code>transactionAddHandlers.ts</code>: Validaci√≥n de campos, confirmaci√≥n y respuesta exitosa con nuevo ID.</li>
                    <li><code>transactionReportsHandlers.ts</code>: Generaci√≥n de reportes con datos agrupados, totales y contadores.</li>
                </ul>
            </div>

            <h3>üìä Gu√≠a de Complejidad</h3>
            <table>
                <thead>
                    <tr>
                        <th>Complejidad</th>
                        <th>Puntos</th>
                        <th>Ejemplos en TRANSACTION</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><span class="complexity-badge simple">Simple</span></td>
                        <td>1-2 pts</td>
                        <td>Modificar formato de fecha en tabla, ajustar colores de montos, cambiar texto de botones o mensajes.</td>
                    </tr>
                    <tr>
                        <td><span class="complexity-badge medium">Medio</span></td>
                        <td>3-5 pts</td>
                        <td>Agregar campo de filtro por tipo de transacci√≥n, implementar exportaci√≥n a CSV de lista, mejorar validaciones de formulario.</td>
                    </tr>
                    <tr>
                        <td><span class="complexity-badge complex">Complejo</span></td>
                        <td>5-8 pts</td>
                        <td>Implementar nuevo tipo de reporte con l√≥gica de agrupaci√≥n diferente, integrar backend real para transacciones, agregar m√≥dulo de conciliaci√≥n.</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section class="technical">
            <h2>üîß Fundamentos T√©cnicos</h2>
            
            <h3>üèóÔ∏è Componentes Clave</h3>
            
            <div class="component-card">
                <h4>TransactionListScreen.tsx</h4>
                <p><strong>Prop√≥sito:</strong> Tabla de transacciones con b√∫squeda, paginaci√≥n manual y selecci√≥n.</p>
                <p><strong>Tecnolog√≠as:</strong> Material-UI (Table, TextField, Button, Chip), custom hooks.</p>
                <p><strong>Props:</strong></p>
                <ul>
                    <li><code>onTransactionSelect?: (transactionId: string) => void</code> - Callback al seleccionar transacci√≥n.</li>
                    <li><code>onError?: (error: string) => void</code> - Callback para errores.</li>
                </ul>
                <p><strong>Teclas de funci√≥n:</strong></p>
                <ul>
                    <li>F3: Volver al men√∫ principal.</li>
                    <li>F7: P√°gina anterior (si disponible).</li>
                    <li>F8: P√°gina siguiente (si disponible).</li>
                    <li>ENTER: Procesar selecci√≥n (campo 'S').</li>
                </ul>
            </div>

            <div class="component-card">
                <h4>TransactionViewScreen.tsx</h4>
                <p><strong>Prop√≥sito:</strong> Vista detallada de una transacci√≥n individual.</p>
                <p><strong>Tecnolog√≠as:</strong> Material-UI (Grid, Card, TextField), formateo de fechas y montos.</p>
                <p><strong>Props:</strong></p>
                <ul>
                    <li><code>initialTransactionId?: string</code> - ID inicial para carga autom√°tica.</li>
                    <li><code>onError?: (error: string) => void</code> - Callback para errores.</li>
                </ul>
                <p><strong>Secciones de informaci√≥n:</strong></p>
                <ul>
                    <li>Informaci√≥n B√°sica: ID, Card Number, Type Code, Category Code, Source.</li>
                    <li>Informaci√≥n Financiera: Amount (con formato USD), Original/Processed Dates.</li>
                    <li>Informaci√≥n del Comerciante: Merchant ID, Name, City, Zip con iconos.</li>
                </ul>
            </div>

            <div class="component-card">
                <h4>TransactionAddScreen.tsx</h4>
                <p><strong>Prop√≥sito:</strong> Formulario de alta de transacciones con confirmaci√≥n.</p>
                <p><strong>Flujo:</strong></p>
                <ol>
                    <li>Formulario inicial: Captura de todos los campos (identificaci√≥n, transacci√≥n, comerciante).</li>
                    <li>Validaci√≥n: Al presionar bot√≥n o F5, se validan todos los campos.</li>
                    <li>Pantalla de confirmaci√≥n: Muestra resumen y solicita confirmaci√≥n Y/N.</li>
                    <li>Guardado: Si confirmaci√≥n es 'Y', se env√≠a al backend y se muestra resultado.</li>
                </ol>
                <p><strong>Validaciones implementadas:</strong></p>
                <ul>
                    <li>Account ID o Card Number requerido (al menos uno).</li>
                    <li>Transaction fields: Type Code, Category Code, Source, Description, Amount.</li>
                    <li>Fechas: Original Date y Process Date con validaci√≥n de formato.</li>
                    <li>Merchant: ID, Name, City, Zip todos obligatorios.</li>
                </ul>
            </div>

            <div class="component-card">
                <h4>TransactionReportsScreen.tsx + TransactionReportTable.tsx</h4>
                <p><strong>Prop√≥sito:</strong> Generaci√≥n y visualizaci√≥n de reportes de transacciones.</p>
                <p><strong>Tipos de reporte:</strong></p>
                <ul>
                    <li><strong>Monthly:</strong> Reporte del mes actual (fechas autom√°ticas).</li>
                    <li><strong>Yearly:</strong> Reporte del a√±o actual (fechas autom√°ticas).</li>
                    <li><strong>Custom:</strong> Rango de fechas personalizado (start/end date obligatorios).</li>
                </ul>
                <p><strong>Estructura de datos del reporte:</strong></p>
                <ul>
                    <li><code>reportType</code>: Tipo de reporte generado.</li>
                    <li><code>accountGroups</code>: Array de grupos por cuenta con transacciones y subtotales.</li>
                    <li><code>grandTotal</code>: Suma total de todas las transacciones.</li>
                    <li><code>totalTransactionCount</code>: N√∫mero total de transacciones.</li>
                    <li><code>accountCount</code>: N√∫mero de cuentas en el reporte.</li>
                </ul>
            </div>

            <h3>üîó Integraciones y Dependencias</h3>
            
            <div class="component-card">
                <h4>API Endpoints</h4>
                <p><strong>Base URL:</strong> <code>/api/transactions</code></p>
                <table>
                    <thead>
                        <tr>
                            <th>Endpoint</th>
                            <th>M√©todo</th>
                            <th>Descripci√≥n</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>/list</code></td>
                            <td>POST</td>
                            <td>Listar transacciones con paginaci√≥n y b√∫squeda</td>
                        </tr>
                        <tr>
                            <td><code>/next-page</code></td>
                            <td>POST</td>
                            <td>Obtener p√°gina siguiente de transacciones</td>
                        </tr>
                        <tr>
                            <td><code>/previous-page</code></td>
                            <td>POST</td>
                            <td>Obtener p√°gina anterior de transacciones</td>
                        </tr>
                        <tr>
                            <td><code>/view</code></td>
                            <td>POST</td>
                            <td>Obtener detalles de una transacci√≥n por ID</td>
                        </tr>
                        <tr>
                            <td><code>/add</code></td>
                            <td>POST</td>
                            <td>Crear nueva transacci√≥n</td>
                        </tr>
                        <tr>
                            <td><code>/reports</code></td>
                            <td>POST</td>
                            <td>Generar reporte de transacciones</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="component-card">
                <h4>Tipos de Datos (TypeScript)</h4>
                <div class="code-block">
// TransactionItem (para lista)
interface TransactionItem {
  transactionId: string;
  date: string; // MM/DD/YY
  description: string;
  amount: number;
}

// TransactionViewResponse (detalles completos)
interface TransactionViewResponse {
  transactionId?: string;
  cardNumber?: string;
  transactionTypeCode?: string;
  transactionCategoryCode?: string;
  transactionSource?: string;
  transactionAmount?: string;
  transactionDescription?: string;
  originalTimestamp?: string;
  processedTimestamp?: string;
  merchantId?: string;
  merchantName?: string;
  merchantCity?: string;
  merchantZip?: string;
}

// TransactionAddRequest (alta)
interface TransactionAddRequest {
  accountId?: string;
  cardNumber?: string;
  transactionTypeCode: string;
  transactionCategoryCode: string;
  transactionSource: string;
  transactionDescription: string;
  transactionAmount: string;
  originalDate: string;
  processDate: string;
  merchantId: string;
  merchantName: string;
  merchantCity: string;
  merchantZip: string;
  confirmation: 'Y' | 'N' | '';
}

// ReportData (reportes)
interface ReportData {
  reportType: string;
  startDate: string;
  endDate: string;
  accountGroups: AccountGroup[];
  grandTotal: number;
  totalTransactionCount: number;
  accountCount: number;
}
                </div>
            </div>

            <div class="component-card">
                <h4>SystemHeader Component</h4>
                <p>Todas las pantallas de transacciones utilizan el componente <code>SystemHeader</code> que muestra:</p>
                <ul>
                    <li><strong>transactionId:</strong> C√≥digo de transacci√≥n legacy (CT00, CT01, CT02, etc.).</li>
                    <li><strong>programName:</strong> Nombre del programa COBOL original (COTRN00C, COTRN01C, etc.).</li>
                    <li><strong>title:</strong> T√≠tulo descriptivo de la pantalla.</li>
                    <li><strong>subtitle:</strong> Subt√≠tulo o contexto adicional.</li>
                </ul>
            </div>

            <h3>üé® Patrones de UI/UX</h3>
            
            <div class="component-card">
                <h4>Formateo de Montos</h4>
                <div class="code-block">
const formatAmount = (amount: number): string => {
  return new Intl.NumberFormat('en-US', {
    style: 'currency',
    currency: 'USD',
    minimumFractionDigits: 2,
  }).format(amount);
};

// Uso en UI: colores diferenciados
&lt;Typography 
  color={amount < 0 ? 'error.main' : 'success.main'}
&gt;
  {formatAmount(amount)}
&lt;/Typography&gt;
                </div>
            </div>

            <div class="component-card">
                <h4>Formateo de Fechas</h4>
                <div class="code-block">
// Para visualizaci√≥n detallada
const formatDateTime = (dateTime: string): string => {
  return new Date(dateTime).toLocaleString('en-US', {
    year: 'numeric',
    month: '2-digit',
    day: '2-digit',
    hour: '2-digit',
    minute: '2-digit',
    second: '2-digit',
  });
};

// Para tabla: formato corto MM/DD/YY
date: "01/15/24"
                </div>
            </div>

            <div class="component-card">
                <h4>Paginaci√≥n Manual</h4>
                <p><strong>Patr√≥n:</strong> Navegaci√≥n con botones F7/F8 sin paginaci√≥n autom√°tica.</p>
                <ul>
                    <li><code>hasNextPage</code> y <code>hasPreviousPage</code> controlan habilitaci√≥n de botones.</li>
                    <li>Al cambiar p√°gina, se trackean <code>firstTransactionId</code> y <code>lastTransactionId</code> para el backend.</li>
                    <li>Loading states durante la carga de nuevas p√°ginas.</li>
                    <li>Indicador de p√°gina actual en chip visual.</li>
                </ul>
            </div>

            <div class="component-card">
                <h4>Selecci√≥n tipo Mainframe</h4>
                <p><strong>Patr√≥n:</strong> Campo de input de 1 car√°cter por fila, usuario escribe 'S' y presiona ENTER o √≠cono.</p>
                <div class="code-block">
// Estado de selecci√≥n por transacci√≥n
const [selectionInputs, setSelectionInputs] = 
  useState&lt;Record&lt;string, string&gt;&gt;({});

// Handler de cambio
const handleSelectionChange = (transactionId: string, value: string) => {
  setSelectionInputs(prev => ({ 
    ...prev, 
    [transactionId]: value.toUpperCase() 
  }));
};

// Handler de submit
const handleSelectionSubmit = (transactionId: string) => {
  const selection = selectionInputs[transactionId];
  if (selection === 'S') {
    // Navegar a vista detallada
    onTransactionSelect(transactionId);
  }
};
                </div>
            </div>

            <div class="component-card">
                <h4>Flujo de Confirmaci√≥n (Two-Step)</h4>
                <p><strong>Usado en:</strong> TransactionAddScreen, TransactionReportsScreen</p>
                <ol>
                    <li><strong>Paso 1 - Formulario:</strong> Captura de datos, validaci√≥n en tiempo real.</li>
                    <li><strong>Paso 2 - Confirmaci√≥n:</strong> Pantalla de revisi√≥n con campos en modo lectura, campo de confirmaci√≥n Y/N.</li>
                    <li><strong>Guardado:</strong> Solo si confirmaci√≥n es 'Y', se env√≠a al backend.</li>
                    <li><strong>Resultado:</strong> Mensaje de √©xito/error y limpieza de formulario.</li>
                </ol>
                <p><strong>Estado controlado por:</strong> <code>isConfirmationStep</code> boolean en el hook.</p>
            </div>
        </section>

        <section class="acceptance">
            <h2>‚úÖ Ejemplos de Criterios de Aceptaci√≥n</h2>
            
            <div class="highlight">
                <h3>US: Listado de transacciones con paginaci√≥n</h3>
                <p><strong>Dado</strong> que soy un operador autenticado en la pantalla de lista de transacciones</p>
                <p><strong>Cuando</strong> cargo la p√°gina inicial</p>
                <p><strong>Entonces</strong></p>
                <ul>
                    <li>Veo las primeras 10 transacciones ordenadas por fecha/ID</li>
                    <li>Veo el n√∫mero de p√°gina actual en un chip destacado</li>
                    <li>El bot√≥n F7 (Backward) est√° deshabilitado en la primera p√°gina</li>
                    <li>El bot√≥n F8 (Forward) est√° habilitado si hay m√°s p√°ginas</li>
                    <li>Cada fila muestra: Transaction ID, Date (MM/DD/YY), Description, Amount formateado</li>
                    <li>Los montos negativos se muestran en rojo, los positivos en verde</li>
                </ul>
            </div>

            <div class="highlight">
                <h3>US: B√∫squeda de transacci√≥n por ID</h3>
                <p><strong>Dado</strong> que estoy en la pantalla de lista de transacciones</p>
                <p><strong>Cuando</strong> ingreso un Transaction ID num√©rico v√°lido y presiono ENTER o el bot√≥n Search</p>
                <p><strong>Entonces</strong></p>
                <ul>
                    <li>Se ejecuta la b√∫squeda y se actualiza la lista con los resultados</li>
                    <li>Si la transacci√≥n existe, se muestra en la tabla</li>
                    <li>Si no existe, se muestra un mensaje de error descriptivo</li>
                    <li>El campo de b√∫squeda se limpia despu√©s de una b√∫squeda exitosa (opcional)</li>
                    <li>Los errores de validaci√≥n (ej. formato incorrecto) se muestran bajo el campo</li>
                </ul>
            </div>

            <div class="highlight">
                <h3>US: Selecci√≥n y vista de detalle</h3>
                <p><strong>Dado</strong> que veo la lista de transacciones</p>
                <p><strong>Cuando</strong> escribo 'S' en el campo de selecci√≥n de una fila y presiono ENTER o el √≠cono de ojo</p>
                <p><strong>Entonces</strong></p>
                <ul>
                    <li>Navego a la pantalla de vista detallada de esa transacci√≥n</li>
                    <li>La pantalla muestra toda la informaci√≥n de la transacci√≥n organizada en secciones</li>
                    <li>Veo informaci√≥n b√°sica, financiera y del comerciante con iconos visuales</li>
                    <li>Los montos est√°n formateados en USD con 2 decimales</li>
                    <li>Las fechas est√°n formateadas en formato legible</li>
                    <li>Puedo regresar a la lista con F3 o el bot√≥n Back</li>
                </ul>
            </div>

            <div class="highlight">
                <h3>US: Alta de transacci√≥n con validaci√≥n</h3>
                <p><strong>Dado</strong> que estoy en la pantalla de alta de transacciones</p>
                <p><strong>Cuando</strong> completo todos los campos obligatorios correctamente y presiono F5 o el bot√≥n de confirmaci√≥n</p>
                <p><strong>Entonces</strong></p>
                <ul>
                    <li>Veo una pantalla de confirmaci√≥n con todos los datos en modo lectura</li>
                    <li>Se me solicita confirmaci√≥n con campo Y/N</li>
                    <li><strong>Si confirmo con 'Y':</strong>
                        <ul>
                            <li>La transacci√≥n se guarda en el sistema</li>
                            <li>Veo un mensaje de √©xito con el nuevo Transaction ID generado</li>
                            <li>El formulario se limpia autom√°ticamente</li>
                        </ul>
                    </li>
                    <li><strong>Si confirmo con 'N' o cancelo:</strong>
                        <ul>
                            <li>Regreso al formulario de alta con los datos intactos</li>
                            <li>Puedo modificar campos y reintentar</li>
                        </ul>
                    </li>
                </ul>
            </div>

            <div class="highlight">
                <h3>US: Validaciones del formulario de alta</h3>
                <p><strong>Dado</strong> que estoy completando el formulario de alta de transacciones</p>
                <p><strong>Cuando</strong> intento avanzar sin completar campos obligatorios</p>
                <p><strong>Entonces</strong></p>
                <ul>
                    <li>Veo mensajes de error espec√≠ficos bajo cada campo incompleto o inv√°lido</li>
                    <li>El bot√≥n de confirmaci√≥n permanece habilitado pero la validaci√≥n impide avanzar</li>
                    <li><strong>Validaciones espec√≠ficas:</strong>
                        <ul>
                            <li>Account ID o Card Number: al menos uno es obligatorio</li>
                            <li>Transaction Amount: debe ser un n√∫mero v√°lido con m√°ximo 2 decimales</li>
                            <li>Fechas: formato v√°lido reconocible (ISO o texto)</li>
                            <li>Merchant fields: todos obligatorios (ID, Name, City, Zip)</li>
                            <li>Type Code y Category Code: no vac√≠os</li>
                        </ul>
                    </li>
                </ul>
            </div>

            <div class="highlight">
                <h3>US: Generaci√≥n de reporte mensual</h3>
                <p><strong>Dado</strong> que estoy en la pantalla de reportes de transacciones</p>
                <p><strong>Cuando</strong> selecciono el tab "Monthly Report" y confirmo con 'Y'</p>
                <p><strong>Entonces</strong></p>
                <ul>
                    <li>Se genera un reporte con las transacciones del mes actual</li>
                    <li>Las fechas de inicio y fin se calculan autom√°ticamente (primer y √∫ltimo d√≠a del mes)</li>
                    <li>El reporte muestra transacciones agrupadas por Card Number y Account ID</li>
                    <li>Cada grupo muestra: subtotal de la cuenta y n√∫mero de transacciones</li>
                    <li>Al final veo: Grand Total, Total Transaction Count, Account Count</li>
                    <li>Cada transacci√≥n muestra: ID, Type/Category (con descripciones), Amount (con color), Processed Date</li>
                </ul>
            </div>

            <div class="highlight">
                <h3>US: Reporte personalizado con validaci√≥n de rango</h3>
                <p><strong>Dado</strong> que estoy en el tab "Custom Report"</p>
                <p><strong>Cuando</strong> ingreso un rango de fechas donde Start Date > End Date</p>
                <p><strong>Entonces</strong></p>
                <ul>
                    <li>Veo un mensaje de error indicando que el rango es inv√°lido</li>
                    <li>No puedo confirmar la generaci√≥n del reporte hasta corregir las fechas</li>
                    <li>Los mensajes de error son claros y espec√≠ficos: "Start date must be before or equal to end date"</li>
                </ul>
                <p><strong>Y cuando</strong> corrijo las fechas con un rango v√°lido y confirmo con 'Y'</p>
                <p><strong>Entonces</strong></p>
                <ul>
                    <li>Se genera el reporte con las transacciones en ese rango</li>
                    <li>La estructura es id√©ntica a los reportes mensuales/anuales</li>
                </ul>
            </div>
        </section>

        <section class="testing">
            <h2>üß™ Consideraciones de Testing</h2>
            
            <div class="component-card">
                <h4>Mock Data (MSW)</h4>
                <p>Para pruebas con <code>VITE_USE_MOCKS=true</code>, los handlers incluyen:</p>
                <ul>
                    <li><strong>transactionListHandlers:</strong> 30+ transacciones de muestra con montos variados (positivos/negativos), fechas secuenciales, paginaci√≥n simulada.</li>
                    <li><strong>transactionViewHandlers:</strong> Detalles completos por ID, incluyendo informaci√≥n de comerciante variada.</li>
                    <li><strong>transactionAddHandlers:</strong> Validaci√≥n de campos, generaci√≥n de nuevo ID, respuestas de √©xito/error.</li>
                    <li><strong>transactionReportsHandlers:</strong> Generaci√≥n de reportes con 3-5 cuentas agrupadas, transacciones variadas, totales calculados.</li>
                </ul>
            </div>

            <div class="component-card">
                <h4>Escenarios de Prueba Clave</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Escenario</th>
                            <th>Qu√© verificar</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Carga inicial de lista</td>
                            <td>10 transacciones visibles, paginaci√≥n correcta, botones habilitados/deshabilitados seg√∫n contexto.</td>
                        </tr>
                        <tr>
                            <td>B√∫squeda por ID existente</td>
                            <td>Transacci√≥n encontrada, datos mostrados correctamente, sin errores.</td>
                        </tr>
                        <tr>
                            <td>B√∫squeda por ID inexistente</td>
                            <td>Mensaje de error claro, lista vac√≠a o sin cambios, no crash.</td>
                        </tr>
                        <tr>
                            <td>Paginaci√≥n F7/F8</td>
                            <td>Cambio correcto de p√°gina, datos actualizados, botones se habilitan/deshabilitan din√°micamente.</td>
                        </tr>
                        <tr>
                            <td>Selecci√≥n 'S' y navegaci√≥n</td>
                            <td>Redirecci√≥n correcta a /transaction/view/:id, datos cargados en destino.</td>
                        </tr>
                        <tr>
                            <td>Alta sin campos obligatorios</td>
                            <td>Mensajes de error espec√≠ficos, no se permite avanzar a confirmaci√≥n.</td>
                        </tr>
                        <tr>
                            <td>Alta con confirmaci√≥n 'N'</td>
                            <td>Regreso a formulario, datos intactos, no se guarda nada.</td>
                        </tr>
                        <tr>
                            <td>Alta con confirmaci√≥n 'Y'</td>
                            <td>Guardado exitoso, mensaje con nuevo ID, formulario limpio.</td>
                        </tr>
                        <tr>
                            <td>Reporte Custom con rango inv√°lido</td>
                            <td>Error de validaci√≥n, no se genera reporte, mensaje claro.</td>
                        </tr>
                        <tr>
                            <td>Reporte generado correctamente</td>
                            <td>Agrupaci√≥n por cuenta, subtotales correctos, grand total cuadra, contadores precisos.</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="component-card">
                <h4>Testing de Teclas de Funci√≥n</h4>
                <p>Verificar que todas las teclas de funci√≥n funcionan en cada pantalla:</p>
                <ul>
                    <li><strong>F3:</strong> Siempre regresa al men√∫ o pantalla anterior.</li>
                    <li><strong>F4:</strong> Limpia el formulario/pantalla (donde aplica).</li>
                    <li><strong>F5:</strong> Acci√≥n principal (Browse, Save, etc. seg√∫n contexto).</li>
                    <li><strong>F7:</strong> P√°gina anterior (paginaci√≥n).</li>
                    <li><strong>F8:</strong> P√°gina siguiente (paginaci√≥n).</li>
                    <li><strong>F12/ESC:</strong> Salir/cancelar.</li>
                    <li><strong>ENTER:</strong> Acci√≥n contextual (b√∫squeda, selecci√≥n, confirmaci√≥n).</li>
                </ul>
            </div>
        </section>

        <section class="navigation">
            <h2>üó∫Ô∏è Navegaci√≥n y Rutas</h2>
            
            <div class="component-card">
                <h4>Rutas del M√≥dulo Transaction</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Ruta</th>
                            <th>Componente</th>
                            <th>Descripci√≥n</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>/transaction/list</code></td>
                            <td>TransactionListPage</td>
                            <td>Lista de transacciones con b√∫squeda y paginaci√≥n</td>
                        </tr>
                        <tr>
                            <td><code>/transaction/view/:id?</code></td>
                            <td>TransactionViewPage</td>
                            <td>Vista detallada de transacci√≥n (ID opcional desde URL)</td>
                        </tr>
                        <tr>
                            <td><code>/transaction/add</code></td>
                            <td>TransactionAddPage</td>
                            <td>Formulario de alta de transacci√≥n nueva</td>
                        </tr>
                        <tr>
                            <td><code>/transaction/reports</code></td>
                            <td>TransactionReportsPage</td>
                            <td>Generaci√≥n y visualizaci√≥n de reportes</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="component-card">
                <h4>Flujos de Navegaci√≥n T√≠picos</h4>
                <ol>
                    <li><strong>Consulta r√°pida:</strong> Menu ‚Üí List ‚Üí Seleccionar 'S' ‚Üí View ‚Üí F3 (back to List) ‚Üí F3 (back to Menu)</li>
                    <li><strong>Alta de transacci√≥n:</strong> Menu ‚Üí Add ‚Üí Completar formulario ‚Üí Confirmar 'Y' ‚Üí √âxito ‚Üí F3 (back to Menu)</li>
                    <li><strong>B√∫squeda espec√≠fica:</strong> Menu ‚Üí List ‚Üí Search by ID ‚Üí F5 (Browse) ‚Üí View con ID cargado ‚Üí F3 (back)</li>
                    <li><strong>Generaci√≥n de reporte:</strong> Menu ‚Üí Reports ‚Üí Seleccionar tipo ‚Üí Confirmar ‚Üí Ver reporte ‚Üí F5 (regenerar) o F3 (salir)</li>
                </ol>
            </div>
        </section>

        <div style="margin-top: 3rem; text-align: center;">
            <a href="../../index.html" class="back-link">‚Üê Volver a la documentaci√≥n principal</a>
        </div>
    </div>
</body>
</html>
